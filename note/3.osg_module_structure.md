# osg 核心模块详细描述

## osg - 核心库

**功能概述：** 提供场景图、节点、渲染、几何、状态管理等基础功能。

**主要组件：**

### 场景图基础
- **Node** - 场景图中所有节点的基类
  - 提供访问者模式支持 (`accept()` 方法)
  - 管理父节点关系 (`getParents()`, `getNumParents()`)
  - 支持节点掩码和边界球计算
  - 提供类型转换方法 (`asGroup()`, `asTransform()` 等)

- **Group** - 包含子节点的组节点
  - 管理子节点列表
  - 提供添加/删除子节点的方法
  - 支持子节点遍历

- **Geode** - 几何节点，包含可绘制对象
  - 管理Drawable对象列表
  - 提供几何体的容器功能

### 变换系统
- **Transform** - 变换节点基类
- **MatrixTransform** - 矩阵变换节点
- **PositionAttitudeTransform** - 位置姿态变换
- **Projection** - 投影变换

### 渲染状态
- **StateSet** - 渲染状态集合
  - 管理纹理、材质、着色器等状态属性
  - 支持渲染模式设置
  - 提供状态继承机制

- **StateAttribute** - 渲染状态属性基类
  - **Texture** - 纹理管理
  - **Material** - 材质系统
  - **Light** - 光照系统
  - **BlendFunc** - 混合函数
  - **Depth** - 深度测试

### 几何系统
- **Geometry** - 几何体基类
  - 管理顶点、法线、纹理坐标等属性
  - 支持多种图元类型
  - 提供几何体优化功能

- **Drawable** - 可绘制对象基类
  - 定义渲染接口
  - 支持边界计算
  - 提供更新回调机制

### 数学工具
- **Vec2/3/4** - 向量类 (支持多种数据类型)
- **Matrix** - 矩阵类
- **Quat** - 四元数类
- **BoundingSphere/Box** - 边界体类

### 内存管理
- **Referenced** - 引用计数基类
- **ref_ptr** - 智能指针模板
- **observer_ptr** - 观察者指针

## 开发建议

1. **场景图设计**：使用Node、Group、Geode构建场景层次结构
2. **状态管理**：利用StateSet管理渲染状态，提高渲染效率
3. **几何处理**：使用Geometry和Drawable创建可渲染对象
4. **内存安全**：使用ref_ptr智能指针避免内存泄漏
5. **数学计算**：利用Vec、Matrix、Quat等数学工具进行3D计算

## 总结

osg核心库是OpenSceneGraph的基础，提供了完整的场景图架构、渲染状态管理、几何处理和数学工具。通过合理的场景图设计和状态管理，可以构建高效、稳定的3D应用程序。 